"use strict";function psp_update_sub_task_progress(t,e,s,a,p,r,i,n){var d=jQuery("#psp-ajax-url").val();jQuery.ajax({url:d+"?action=psp_update_sub_task_fe",type:"post",data:{project_id:t,phase_id:e,task_id:s,parent_id:a,progress:r},success:function(s){parseInt(e)+1;p.find("span.psp-progress-bar em").removeClass().addClass("status").addClass("psp-"+s.data.parent_progress),p.attr("data-progress",s.data.parent_progress),psp_update_my_task_count(t,e),"undefined"!=typeof i&&"Yes"==i&&psp_update_phase_completion(t,e),"undefined"!=typeof n&&"Yes"==n&&psp_update_total_progress(t)},error:function(t){console.log(t)}})}jQuery(document).ready(function(t){t("#psp-phases, #psp-archive-content").on("click",".complete-sub-task-link",function(e){e.preventDefault();var s=(t(this).attr("data-target"),t(this).attr("data-project")),a=t(this).attr("data-phase"),p=t(this).attr("data-parent_id"),r=t(this).attr("data-task"),i=100,n=t(this).attr("data-phase-auto"),d=t(this).attr("data-overall-auto"),l=t(".psp-single-"+s+" .phase-"+(parseInt(a)+1)+" .task-item-"+p+", .psp-task-project-"+s+" .task-item-"+p+", .project-"+s+"-task-"+p);psp_update_sub_task_progress(s,a,r,p,l,i,n,d);var o=t(this).parents(".sub-task-item-"+r),u=t(o).children("span").children("em");"100"==i?t(o).addClass("complete"):t(o).removeClass("complete"),t(u).removeClass().addClass("status").addClass("psp-"+i),t(o).attr("data-progress",i)}),t("#psp-phases, #psp-archive-content").on("click",".sub-task-save-button",function(e){e.preventDefault();var s=t(this).siblings("#edit-sub-task-select-"+t(this).attr("data-phase")+"-"+t(this).attr("data-task")),a=t(this).attr("data-project"),p=t(this).attr("data-phase"),r=t(this).attr("data-parent_id"),i=t(this).attr("data-task"),n=t(s).val(),d=(t(this).parents(".task-select"),t(this).attr("data-phase-auto")),l=t(this).attr("data-overall-auto"),o=t(".psp-single-"+a+" .phase-"+(parseInt(p)+1)+" .task-item-"+r+", .psp-task-project-"+a+" .task-item-"+r+", .project-"+a+"-task-"+r);psp_update_sub_task_progress(a,p,i,r,o,n,d,l);var u=t(this).parents(".sub-task-item-"+i),c=t(u).children("span").children("em");t(c).removeClass().addClass("status").addClass("psp-"+n),t(u).attr("data-progress",n),"100"==n?t(u).addClass("complete"):t(u).removeClass("complete"),t(this).parents(".sub-task-select").fadeOut("slow")}),t("#psp-phases, #psp-archive-content").on("click",".sub-task-edit-link",function(e){e.preventDefault();var s=t(this).parents(".sub-task-item");t(s).children(".sub-task-select").fadeIn("slow")})}),function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;t.find('.psp_st-fieldhelpers-field[data-fieldhelpers-name="sub_tasks"] .fieldhelpers-field-repeater-row').remove()}function s(e){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;for(var a in e)s.find('.psp_st-fieldhelpers-field[data-fieldhelpers-name="sub_tasks"] .fieldhelpers-field-repeater-add-button').click();s.find('.psp_st-fieldhelpers-field[data-fieldhelpers-name="sub_tasks"] .fieldhelpers-field-repeater-row').each(function(s,a){var p=e[s];for(var r in p){var i=p[r];t(a).find('*[name$="'+r+']"]').val(i)}})}t(document).ready(function(){t("#psp-phases").on("click",".fe-edit-task-link",function(a){var p=t(this).attr("href"),r=t(p),i=t(this).data(),n=i.sub_task;e(r),s(n,r),r.find("input[data-fieldhelpers-field-datepicker]").each(function(e,s){var a=t(s).next('input[type="hidden"]').val(),p=a.substring(4,6),r=a.substring(6,8),i=a.substring(0,4),n=new Date(i+"-"+p+"-"+r);""!=t(s).next('input[type="hidden"]').val()?n.setTime(n.getTime()+60*n.getTimezoneOffset()*1e3):n=null,t(s).datepicker("setDate",n)})}),t("#psp-phases").on("click",".psp-fe-add-element",function(s){var a=t(this).attr("href"),p=t(a);e(p)})}),t(document).on("psp-fe-deleted-task",function(e,s,a){"function"==typeof rbmFHinitField&&rbmFHinitField(t('.psp_st-fieldhelpers-field[data-fieldhelpers-name="sub_tasks"]').closest(".psp-frontend-field"))})}(jQuery);
//# sourceMappingURL=script.js.map
