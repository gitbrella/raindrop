{"version":3,"sources":["script.js","subtasks.js","psp-frontend-editor/populate-modal.js"],"names":["psp_update_sub_task_progress","project_id","phase_id","task_id","parent_id","$parentTask","progress","phase_progress","total_progress","ajaxurl","jQuery","val","ajax","url","type","data","success","response","parseInt","find","removeClass","addClass","parent_progress","attr","psp_update_my_task_count","psp_update_phase_completion","psp_update_total_progress","error","console","log","document","ready","$","on","e","preventDefault","this","the_parent","parents","target","children","task_element","siblings","fadeOut","fadeIn","clearRepeater","$modal","arguments","length","undefined","remove","addRows","subTasks","subTask","click","each","index","row","key","value","event","values","preview","date","next","month","substring","day","year","dateObject","Date","setTime","getTime","getTimezoneOffset","datepicker","phase_index","task_index","rbmFHinitField","closest"],"mappings":"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","file":"script.js","sourcesContent":["'use strict';\n\njQuery(document).ready(function ($) {\n\n\t$('#psp-phases, #psp-archive-content').on('click', '.complete-sub-task-link', function (e) {\n\n\t\te.preventDefault();\n\n\t\tvar formID = $(this).attr('data-target');\n\t\tvar project_id = $(this).attr('data-project');\n\t\tvar phase_id = $(this).attr('data-phase');\n\t\tvar parent_id = $(this).attr('data-parent_id');\n\t\tvar task_id = $(this).attr('data-task');\n\t\tvar progress = 100;\n\n\t\tvar phase_progress = $(this).attr('data-phase-auto');\n\t\tvar total_progress = $(this).attr('data-overall-auto');\n\n\t\t// Single, Dashboard, and Your Tasks view\n\t\tvar $parentTask = $('.psp-single-' + project_id + ' .phase-' + (parseInt(phase_id) + 1) + ' .task-item-' + parent_id + ', .psp-task-project-' + project_id + ' .task-item-' + parent_id + ', .project-' + project_id + '-task-' + parent_id);\n\n\t\t// Update dynamically\n\t\tpsp_update_sub_task_progress(project_id, phase_id, task_id, parent_id, $parentTask, progress, phase_progress, total_progress);\n\n\t\tvar the_parent = $(this).parents('.sub-task-item-' + task_id),\n\t\t    target = $(the_parent).children('span').children('em');\n\n\t\tif (progress == '100') {\n\t\t\t$(the_parent).addClass('complete');\n\t\t} else {\n\t\t\t$(the_parent).removeClass('complete');\n\t\t}\n\n\t\t$(target).removeClass().addClass('status').addClass('psp-' + progress);\n\t\t$(the_parent).attr('data-progress', progress);\n\t});\n\n\t$('#psp-phases, #psp-archive-content').on('click', '.sub-task-save-button', function (e) {\n\n\t\te.preventDefault();\n\n\t\tvar task_element = $(this).siblings('#edit-sub-task-select-' + $(this).attr('data-phase') + '-' + $(this).attr('data-task'));\n\n\t\tvar project_id = $(this).attr('data-project');\n\t\tvar phase_id = $(this).attr('data-phase');\n\t\tvar parent_id = $(this).attr('data-parent_id');\n\t\tvar task_id = $(this).attr('data-task');\n\t\tvar progress = $(task_element).val();\n\t\tvar parent_div = $(this).parents('.task-select');\n\n\t\tvar phase_progress = $(this).attr('data-phase-auto');\n\t\tvar total_progress = $(this).attr('data-overall-auto');\n\n\t\t// Single, Dashboard, and Your Tasks view\n\t\tvar $parentTask = $('.psp-single-' + project_id + ' .phase-' + (parseInt(phase_id) + 1) + ' .task-item-' + parent_id + ', .psp-task-project-' + project_id + ' .task-item-' + parent_id + ', .project-' + project_id + '-task-' + parent_id);\n\n\t\tpsp_update_sub_task_progress(project_id, phase_id, task_id, parent_id, $parentTask, progress, phase_progress, total_progress);\n\n\t\tvar the_parent = $(this).parents('.sub-task-item-' + task_id),\n\t\t    target = $(the_parent).children('span').children('em');\n\n\t\t$(target).removeClass().addClass('status').addClass('psp-' + progress);\n\t\t$(the_parent).attr('data-progress', progress);\n\n\t\tif (progress == '100') {\n\t\t\t$(the_parent).addClass('complete');\n\t\t} else {\n\t\t\t$(the_parent).removeClass('complete');\n\t\t}\n\n\t\t$(this).parents('.sub-task-select').fadeOut('slow');\n\t});\n\n\t$('#psp-phases, #psp-archive-content').on('click', '.sub-task-edit-link', function (e) {\n\n\t\te.preventDefault();\n\t\tvar the_parent = $(this).parents('.sub-task-item');\n\t\t$(the_parent).children('.sub-task-select').fadeIn('slow');\n\t});\n});\n\nfunction psp_update_sub_task_progress(project_id, phase_id, task_id, parent_id, $parentTask, progress, phase_progress, total_progress) {\n\n\tvar ajaxurl = jQuery('#psp-ajax-url').val();\n\n\tjQuery.ajax({\n\t\turl: ajaxurl + \"?action=psp_update_sub_task_fe\",\n\t\ttype: 'post',\n\t\tdata: {\n\t\t\tproject_id: project_id,\n\t\t\tphase_id: phase_id,\n\t\t\ttask_id: task_id,\n\t\t\tparent_id: parent_id,\n\t\t\tprogress: progress\n\t\t},\n\t\tsuccess: function success(response) {\n\n\t\t\tvar phase_index = parseInt(phase_id) + 1;\n\n\t\t\t$parentTask.find('span.psp-progress-bar em').removeClass().addClass('status').addClass('psp-' + response.data.parent_progress);\n\t\t\t$parentTask.attr('data-progress', response.data.parent_progress);\n\n\t\t\tpsp_update_my_task_count(project_id, phase_id);\n\n\t\t\tif (typeof phase_progress !== 'undefined' && phase_progress == 'Yes') {\n\t\t\t\tpsp_update_phase_completion(project_id, phase_id);\n\t\t\t}\n\n\t\t\tif (typeof total_progress !== 'undefined' && total_progress == 'Yes') {\n\t\t\t\tpsp_update_total_progress(project_id);\n\t\t\t}\n\t\t},\n\t\terror: function error(data) {\n\t\t\tconsole.log(data);\n\t\t}\n\t});\n}\n'use strict';\n\n(function ($) {\n\n\t$(document).ready(function () {\n\n\t\t$('#psp-phases').on('click', '.fe-edit-task-link', function (event) {\n\n\t\t\tvar target = $(this).attr('href');\n\t\t\tvar $modal = $(target);\n\t\t\tvar values = $(this).data();\n\n\t\t\tvar subTasks = values['sub_task'];\n\n\t\t\tclearRepeater($modal);\n\n\t\t\taddRows(subTasks, $modal);\n\n\t\t\t$modal.find('input[data-fieldhelpers-field-datepicker]').each(function (index, preview) {\n\n\t\t\t\tvar date = $(preview).next('input[type=\"hidden\"]').val(),\n\t\t\t\t    month = date.substring(4, 6),\n\t\t\t\t    day = date.substring(6, 8),\n\t\t\t\t    year = date.substring(0, 4),\n\t\t\t\t    dateObject = new Date(year + '-' + month + '-' + day);\n\n\t\t\t\t// Don't populate a value if there is no due date\n\t\t\t\tif ($(preview).next('input[type=\"hidden\"]').val() != '') {\n\t\t\t\t\t// https://stackoverflow.com/a/16048201\n\t\t\t\t\tdateObject.setTime(dateObject.getTime() + dateObject.getTimezoneOffset() * 60 * 1000);\n\t\t\t\t} else {\n\t\t\t\t\tdateObject = null;\n\t\t\t\t}\n\n\t\t\t\t$(preview).datepicker('setDate', dateObject);\n\t\t\t});\n\t\t});\n\n\t\t$('#psp-phases').on('click', '.psp-fe-add-element', function (event) {\n\n\t\t\tvar target = $(this).attr('href');\n\t\t\tvar $modal = $(target);\n\n\t\t\tclearRepeater($modal);\n\t\t});\n\t});\n\n\t/*\n $( document ).on( 'psp-fe-task-edit-modal-populated', function( event, $modal, values ) {\n \t\t// With our Included Datepicker, we don't want to do it based on the field value. No tomfoolery necessary\n \t$modal.find( 'input.psp-datepicker' ).each( function( index, field ) {\n \t\t\t$( field ).datepicker();\n \t\t} );\n \t} ); */\n\n\t$(document).on('psp-fe-deleted-task', function (event, phase_index, task_index) {\n\n\t\tif (typeof rbmFHinitField === 'function') {\n\n\t\t\t// Re-init the Repeater field\n\t\t\trbmFHinitField($('.psp_st-fieldhelpers-field[data-fieldhelpers-name=\"sub_tasks\"]').closest('.psp-frontend-field'));\n\t\t} else {\n\t\t\t// Oh well, Repeaters will be broken on Task Delete if an older RBM FH is running\n\t\t}\n\t});\n\n\t/**\n  * Clears the Sub Task Repeater of all Values\n  *\n  * @param\t\t{object} $modal Task Edit Modal jQuery Object\n  *\n  * @since\t\t{{VERSION}}\n  * @return\t\tvoid\n  */\n\tfunction clearRepeater() {\n\t\tvar $modal = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n\n\n\t\t$modal.find('.psp_st-fieldhelpers-field[data-fieldhelpers-name=\"sub_tasks\"] .fieldhelpers-field-repeater-row').remove();\n\t}\n\n\t/**\n  * Clears the Sub Task Repeater of all Values\n  *\n  * @param\t\t{Array} subTasks      Array of Objects representing the values for each Row\n  * @param\t\t{object} $modal       Task Edit Modal jQuery Object\n  *\n  * @since\t\t{{VERSION}}\n  * @return\t\tvoid\n  */\n\tfunction addRows(subTasks) {\n\t\tvar $modal = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n\n\n\t\t// Add Rows\n\t\tfor (var subTask in subTasks) {\n\n\t\t\t$modal.find('.psp_st-fieldhelpers-field[data-fieldhelpers-name=\"sub_tasks\"] .fieldhelpers-field-repeater-add-button').click();\n\t\t}\n\n\t\t// Populate Rows\n\t\t$modal.find('.psp_st-fieldhelpers-field[data-fieldhelpers-name=\"sub_tasks\"] .fieldhelpers-field-repeater-row').each(function (index, row) {\n\n\t\t\tvar subTask = subTasks[index];\n\n\t\t\tfor (var key in subTask) {\n\n\t\t\t\tvar value = subTask[key];\n\n\t\t\t\t$(row).find('*[name$=\"' + key + ']\"]').val(value);\n\t\t\t}\n\t\t});\n\t}\n})(jQuery);","jQuery(document).ready(function($) {\n\n    $('#psp-phases, #psp-archive-content').on( 'click', '.complete-sub-task-link', function(e) {\n\n    \te.preventDefault();\n\n        var formID \t\t\t= $(this).attr('data-target');\n        var project_id \t\t= $(this).attr('data-project');\n    \tvar phase_id \t\t= $(this).attr('data-phase');\n        var parent_id       = $(this).attr('data-parent_id');\n    \tvar task_id \t\t= $(this).attr('data-task');\n    \tvar progress \t\t= 100;\n\n    \tvar phase_progress \t= $(this).attr('data-phase-auto');\n    \tvar total_progress \t= $(this).attr('data-overall-auto');\n\n\t\t// Single, Dashboard, and Your Tasks view\n\t\tvar $parentTask = $( '.psp-single-' + project_id + ' .phase-' + ( parseInt( phase_id ) + 1 ) + ' .task-item-' + parent_id + ', .psp-task-project-' + project_id + ' .task-item-' + parent_id + ', .project-' + project_id + '-task-' + parent_id );\n\n    \t// Update dynamically\n    \tpsp_update_sub_task_progress( project_id, phase_id, task_id, parent_id, $parentTask, progress, phase_progress, total_progress );\n\n        var the_parent \t= $(this).parents( '.sub-task-item-' + task_id ),\n        \ttarget \t\t= $(the_parent).children('span').children('em');\n\n        if( progress == '100' ) {\n    \t\t$(the_parent).addClass('complete');\n    \t} else {\n    \t\t$(the_parent).removeClass('complete');\n    \t}\n\n        $(target).removeClass().addClass('status').addClass( 'psp-' + progress );\n        $(the_parent).attr( 'data-progress', progress );\n\n    });\n\n    $('#psp-phases, #psp-archive-content').on( 'click', '.sub-task-save-button', function(e) {\n\n        e.preventDefault();\n\n\t\tvar task_element \t= $(this).siblings('#edit-sub-task-select-' + $(this).attr('data-phase') + '-' + $(this).attr('data-task'));\n\n        var project_id \t\t= $(this).attr('data-project');\n\t\tvar phase_id \t\t= $(this).attr('data-phase');\n        var parent_id       = $(this).attr('data-parent_id');\n\t\tvar task_id \t\t= $(this).attr('data-task');\n\t\tvar progress \t\t= $(task_element).val();\n\t\tvar parent_div \t\t= $(this).parents('.task-select');\n\n\t\tvar phase_progress \t= $(this).attr('data-phase-auto');\n\t\tvar total_progress \t= $(this).attr('data-overall-auto');\n\n\t\t// Single, Dashboard, and Your Tasks view\n\t\tvar $parentTask = $( '.psp-single-' + project_id + ' .phase-' + ( parseInt( phase_id ) + 1 ) + ' .task-item-' + parent_id + ', .psp-task-project-' + project_id + ' .task-item-' + parent_id + ', .project-' + project_id + '-task-' + parent_id );\n\n\t\tpsp_update_sub_task_progress( project_id, phase_id, task_id, parent_id, $parentTask, progress, phase_progress, total_progress );\n\n        var the_parent \t= $(this).parents('.sub-task-item-'+task_id),\n        \ttarget \t\t= $(the_parent).children('span').children('em');\n\n        $(target).removeClass().addClass('status').addClass( 'psp-' + progress );\n        $(the_parent).attr('data-progress',progress);\n\n        if(progress == '100') {\n\t\t\t$(the_parent).addClass('complete');\n\t\t} else {\n\t\t\t$(the_parent).removeClass('complete');\n\t\t}\n\n\t\t$(this).parents('.sub-task-select').fadeOut('slow');\n\n    });\n\n    $('#psp-phases, #psp-archive-content').on( 'click', '.sub-task-edit-link', function(e) {\n\n\t\te.preventDefault();\n\t\tvar the_parent = $(this).parents('.sub-task-item');\n        $(the_parent).children('.sub-task-select').fadeIn('slow');\n\n\t});\n\n});\n\nfunction psp_update_sub_task_progress( project_id, phase_id, task_id, parent_id, $parentTask, progress, phase_progress, total_progress ) {\n\n    var ajaxurl \t\t= jQuery('#psp-ajax-url').val();\n\n\tjQuery.ajax({\n\t\turl: ajaxurl + \"?action=psp_update_sub_task_fe\",\n\t\ttype: 'post',\n\t\tdata: {\n\t\t\tproject_id \t: project_id,\n\t\t\tphase_id\t: phase_id,\n\t\t\ttask_id\t\t: task_id,\n            parent_id   : parent_id,\n\t\t\tprogress\t: progress\n\t\t},\n\t\tsuccess: function(response) {\n\n            var phase_index = parseInt(phase_id) + 1;\n\n            $parentTask.find( 'span.psp-progress-bar em' ).removeClass().addClass('status').addClass('psp-' + response.data.parent_progress );\n            $parentTask.attr( 'data-progress', response.data.parent_progress );\n\n\t\t\tpsp_update_my_task_count( project_id, phase_id );\n\n\t\t\tif( typeof phase_progress !== 'undefined' && phase_progress == 'Yes' ) {\n\t\t\t\tpsp_update_phase_completion( project_id, phase_id );\n\t\t\t}\n\n\t\t\tif( typeof total_progress !== 'undefined' && total_progress == 'Yes' ) {\n\t\t\t\tpsp_update_total_progress(project_id);\n\t\t\t}\n\n\t\t},\n\t\terror: function(data) {\n\t\t\tconsole.log(data);\n\t\t}\n\t});\n\n}\n","( function( $ ) {\n\n\t$( document ).ready( function() {\n\n\t\t$( '#psp-phases' ).on( 'click', '.fe-edit-task-link', function( event ) {\n\n\t\t\tvar target = $( this ).attr( 'href' );\n\t\t\tvar $modal = $( target );\n\t\t\tvar values = $( this ).data();\n\n\t\t\tvar subTasks = values['sub_task'];\n\n\t\t\tclearRepeater( $modal );\n\n\t\t\taddRows( subTasks, $modal );\n\n\t\t\t$modal.find( 'input[data-fieldhelpers-field-datepicker]' ).each( function( index, preview ) {\n\n\t\t\t\tvar date = $( preview ).next( 'input[type=\"hidden\"]' ).val(),\n\t\t\t\t\tmonth = date.substring( 4, 6 ),\n\t\t\t\t\tday = date.substring( 6, 8 ),\n\t\t\t\t\tyear = date.substring( 0, 4 ),\n\t\t\t\t\tdateObject = new Date( year + '-' + month + '-' + day );\n\n\t\t\t\t\t// Don't populate a value if there is no due date\n\t\t\t\t\tif( $( preview ).next( 'input[type=\"hidden\"]' ).val() != '' ) {\n\t\t\t\t\t\t// https://stackoverflow.com/a/16048201\n\t\t\t\t\t\tdateObject.setTime( dateObject.getTime() + dateObject.getTimezoneOffset() * 60 * 1000 );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdateObject = null;\n\t\t\t\t\t}\n\n\t\t\t\t\t$( preview ).datepicker( 'setDate', dateObject );\n\n\n\t\t\t} );\n\n\t\t} );\n\n\t\t$( '#psp-phases' ).on( 'click', '.psp-fe-add-element', function( event ) {\n\n\t\t\tvar target = $( this ).attr( 'href' );\n\t\t\tvar $modal = $( target );\n\n\t\t\tclearRepeater( $modal );\n\n\t\t} );\n\n\t} );\n\n\t/*\n\t$( document ).on( 'psp-fe-task-edit-modal-populated', function( event, $modal, values ) {\n\n\t\t// With our Included Datepicker, we don't want to do it based on the field value. No tomfoolery necessary\n\t\t$modal.find( 'input.psp-datepicker' ).each( function( index, field ) {\n\n\t\t\t$( field ).datepicker();\n\n\t\t} );\n\n\t} ); */\n\n\t$( document ).on( 'psp-fe-deleted-task', function( event, phase_index, task_index ) {\n\n\t\tif ( typeof rbmFHinitField === 'function' ) {\n\n\t\t\t// Re-init the Repeater field\n\t\t\trbmFHinitField( $( '.psp_st-fieldhelpers-field[data-fieldhelpers-name=\"sub_tasks\"]' ).closest( '.psp-frontend-field' ) );\n\n\t\t}\n\t\telse {\n\t\t\t// Oh well, Repeaters will be broken on Task Delete if an older RBM FH is running\n\t\t}\n\n\t} );\n\n\t/**\n\t * Clears the Sub Task Repeater of all Values\n\t *\n\t * @param\t\t{object} $modal Task Edit Modal jQuery Object\n\t *\n\t * @since\t\t{{VERSION}}\n\t * @return\t\tvoid\n\t */\n\tfunction clearRepeater( $modal = null ) {\n\n\t\t$modal.find( '.psp_st-fieldhelpers-field[data-fieldhelpers-name=\"sub_tasks\"] .fieldhelpers-field-repeater-row' ).remove();\n\n\t}\n\n\t/**\n\t * Clears the Sub Task Repeater of all Values\n\t *\n\t * @param\t\t{Array} subTasks      Array of Objects representing the values for each Row\n\t * @param\t\t{object} $modal       Task Edit Modal jQuery Object\n\t *\n\t * @since\t\t{{VERSION}}\n\t * @return\t\tvoid\n\t */\n\tfunction addRows( subTasks, $modal = null ) {\n\n\t\t// Add Rows\n\t\tfor ( var subTask in subTasks ) {\n\n\t\t\t$modal.find( '.psp_st-fieldhelpers-field[data-fieldhelpers-name=\"sub_tasks\"] .fieldhelpers-field-repeater-add-button' ).click();\n\n\t\t}\n\n\t\t// Populate Rows\n\t\t$modal.find( '.psp_st-fieldhelpers-field[data-fieldhelpers-name=\"sub_tasks\"] .fieldhelpers-field-repeater-row' ).each( function( index, row ) {\n\n\t\t\tvar subTask = subTasks[ index ];\n\n\t\t\tfor ( var key in subTask ) {\n\n\t\t\t\tvar value = subTask[ key ];\n\n\t\t\t\t$( row ).find( '*[name$=\"' + key + ']\"]' ).val( value );\n\n\t\t\t}\n\n\t\t} );\n\n\n\t}\n\n} )( jQuery );\n"]}